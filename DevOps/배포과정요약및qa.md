## 배포 과정 요약

1. ec2 서버에 docker in docker를 적용한 jenkins 컨테이너를 띄운다.
2. jenkins를 배포할 프로젝트가 있는 레포지토리(의 브랜치)와 연결한다.
3. 해당 브랜치에 특정 이벤트(푸쉬, 머지 등)이 발생하면 jenkins는 설정한 shell script를 실행한다.
4. shell script를 통해 docker-compose를 활용해 Dockerfile을 작동 시켜 react 프로젝트를 이미지화 및 컨테이너화해서 ec2 서버에 배포한다.
5. react는 nginx를 웹서버로 사용해서 배포한다.(본 글에서 포트포워딩 및 ssl 인증서 적용은 다루지 않는다)

## q&a

```
Q: 그냥 바로 ec2 서버에 올리면 되지 왜 도커를 사용하나요?
A: 서버에 react뿐만 아니라 db, backend server 등도 올리게 되기 때문에 각각을 이미지화해서 격리된 컨테이너에서 운영하는 게 관리에 편합니다.

Q: 왜 jenkins를 사용하나요?
A: jenkins는 ci/cd (지속 통합 및 배포) 툴인데 깃랩이나 깃허브 같은 원격 레포지토리와 연결해 특정 이벤트(푸쉬, 머지 등) 발생 시 자동으로 특정 명령(주로 빌드 및 배포)를 수행할 수 있습니다. 프로젝트 과정 중에 수시로 변동사항이 생기는데 매번 수동으로 빌드 및 배포를 하기 보다 젠킨스 같은 ci/cd툴을 사용하면 매우 편리하게 작업할 수 있습니다.

Q: docker-compose를 왜 사용하나요?
A: docker-compose는 기본적으로 여러 개의 도커 컨테이너가 있을 때 해당 도커들의 설정 정보 및 실행을 제어하기 위한 툴입니다. 당연히 한 개의 컨테이너일 경우에도 적용을 할 수 있습니다. 단일 컨테이너의 경우 docker-compse를 사용하면 도커파일의 실행 과정을 아주 조금 간편화 할 수 있다는 장점이 있지만 사실 한 개의 경우 별 차이는 없습니다. 본 글에서 docker-compose를 사용한 이유는 프로젝트 다른 부분에서 멀티 컨테이너를 설정할 일이 있어 어차피 docker-compose를 활용해야 하는 상황이라 겸사겸사 사용했습니다. 

Q: Nginx는 왜 사용하나요
A: react 배포의 웹서버로 활용합니다. nginx는 단일 스레드 비동기 처리 방식으로 요청을 처리하는 고성능 경량 웹서버입니다.(다른 유명한 웹서버인 Apache는 스레드 프로세스 기반으로 nginx에 비해 무겁습니다) spring 서버를 톰캣(톰캣은 아파치입니다)로 배포하듯이 react를 nginx로 배포한다고 이해하면 쉽습니다. 추가로 Nginx는 리버스 프록시 서버로도 활용할 수 있는데 본 글에서는 다루지 않습니다.

Q: 리버스 프록시는 왜 안 하나요?
A: 리버스 프록시는 따로 ec2 server의 nginx 설정을 적용해줘야 돼서 다음 글에서 ssl 인증서와 함께 다루도록 하겠습니다. (같이 할려면 할 수는 있음)
```